<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Model Parameters • surtvep</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Model Parameters">
<meta property="og:description" content="surtvep">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-54921687-5"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-54921687-5');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">surtvep</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/surtvep.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Appendix
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Category A</li>
    <li>
      <a href="../articles/Appendix.html">B-spline construction</a>
    </li>
    <li>
      <a href="../articles/a2.html">Title A2</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Category B</li>
    <li>
      <a href="../articles/plotting.html">Plotting</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Appendix
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Category A</li>
    <li>
      <a href="../articles/Appendix.html">B-spline construction</a>
    </li>
    <li>
      <a href="../articles/a2.html">Title A2</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Category B</li>
    <li>
      <a href="../articles/plotting.html">Plotting</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Appendix2
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Category A</li>
    <li>
      <a href="../articles/Appendix.html">B-spline construction</a>
    </li>
    <li>
      <a href="../articles/a2.html">Title A2</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Category B</li>
    <li>
      <a href="../articles/plotting.html">Plotting</a>
    </li>
  </ul>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Model Parameters</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/UM-KevinHe/surtvep/blob/HEAD/vignettes/Model_Parameters.Rmd" class="external-link"><code>vignettes/Model_Parameters.Rmd</code></a></small>
      <div class="hidden name"><code>Model_Parameters.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="functions">1. Functions<a class="anchor" aria-label="anchor" href="#functions"></a>
</h2>
<div class="section level3">
<h3 id="coxtp">1.1 <code>coxtp</code>:<a class="anchor" aria-label="anchor" href="#coxtp"></a>
</h3>
<p><code>coxtp(event,z,time,strata=c(),spline="P-spline", nsplines=8, ties="Breslow",tol=1e-9, iter.max=20L, method="Newton",</code>
<code>lambda=1e8,factor=10, btr="dynamic", sigma=1e-2, tau=0.6,stop="incre", parallel=FALSE, threads=1L,</code>
<code>degree=3L, TIC = FALSE, TIC_prox = FALSE, lambda_spline = 0, ord = 4, fixedstep = FALSE, effectsize = 0,</code>
<code>difflambda = FALSE,addsecond = FALSE, penalizestop = FALSE, ICLastOnly = FALSE)</code></p>
<p>The main function in our package is <code>coxtp</code> which refers
to the “Cox Non-proportional Hazards model with penalization”.</p>
<div class="section level4">
<h4 id="common-parameters">1.1.1 Common Parameters<a class="anchor" aria-label="anchor" href="#common-parameters"></a>
</h4>
<p><code>coxtp</code> function have two required input, which is
<code>formula</code> and <code>data</code>.</p>
<ul>
<li>
<strong><code>event</code></strong>: Event vector, should be a
vector containing 0 or 1</li>
<li>
<strong><code>z</code></strong>: Covariate matrix</li>
<li>
<strong><code>time</code></strong>: Time vector, should be a vector
with non-negative numeric value</li>
<li>
<strong><code>strata</code></strong>: stratification group defined
in the data. If there exist stratification group, please enter as
vector.</li>
</ul>
</div>
<div class="section level4">
<h4 id="method-related-parameters">1.1.2 Method related Parameters:<a class="anchor" aria-label="anchor" href="#method-related-parameters"></a>
</h4>
<p>Here we offered both model estimation with penalization and without
penalization. Detail method could be found in our paper(add link here).
Following parameters defines the model settings:</p>
<ul>
<li>
<p><strong><code>spline</code></strong>: The spline term for
Penalized Newton’s Method(Add section Number related to the paper).
Default setting is
<strong><code>spline="Smooth-spline"</code></strong></p>
<ul>
<li>
<strong><code>"P-spline"</code></strong>: The P-splines are low rank
smoother using a B-spline basis. Detail information about P-spline could
be found in (Add section number and link)</li>
<li>
<strong><code>"Smooth-spline"</code></strong> : (Add section number
and link)</li>
</ul>
</li>
<li><p><strong><code>nsplines</code></strong> : Number of base functions
in the B-splines, default is 8.</p></li>
<li>
<p><strong><code>method</code></strong> : Selecting Method used,
default is <strong><code>method="Newton"</code></strong></p>
<ul>
<li>
<strong><code>"Newton"</code></strong>: Usual Newton’s
Approach.</li>
<li>
<strong><code>"ProxN"</code></strong> : Proximal Newton–Raphson
Method proposed in our paper(get link here).</li>
</ul>
</li>
<li><p><strong><code>lambda</code></strong> : Parameter for Proximal
Newton’s Method. Default is
<strong><code>lambda=1e8</code></strong></p></li>
<li><p><strong><code>tau</code></strong> : (Alpha or beta?) in the
Newton’s Method, Default is <strong><code>tau=0.5</code></strong>. Used
to control for step size.</p></li>
<li><p><strong><code>lambda_spline</code></strong> : Smoothing parameter
lambda. Default is <strong><code>lambda_spline = 0</code></strong> which
refers to Newton’s Method without penalization.</p></li>
<li>
<p><strong><code>degree</code></strong>: Degree of smoothing spline.
Default setting is <strong><code>degree=3L</code></strong>.</p>
<ul>
<li>
<strong><code>degree=2L</code></strong> refers to Smoothing
quadratic spline.</li>
<li>
<strong><code>degree=3L</code></strong> refers to Smoothing cubic
spline.</li>
</ul>
</li>
<li>
<p><strong><code>ord</code></strong> : Specify which derivative to
penalize. Default setting is <strong><code>ord=4</code></strong>.</p>
<ul>
<li>
<strong><code>ord=4</code></strong>: Penalized second order
derivative, suggest to use this when using the smoothing cubic
spline.</li>
<li>
<strong><code>ord=3</code></strong>: Penalized first order
derivative, suggest to use this when using the smoothing quadratic
spline.</li>
</ul>
</li>
<li><p><code>penalizestop</code>: could delete</p></li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="stopping-creteria-related-parameters">1.1.3 Stopping creteria related Parameters:<a class="anchor" aria-label="anchor" href="#stopping-creteria-related-parameters"></a>
</h3>
<ul>
<li>
<strong><code>tol</code></strong>: Convergence threshold. The
default threshold is set as <strong><code>tol=1e-6</code></strong>
</li>
<li>
<strong><code>iter.max</code></strong>: Maximum Iteration number,
default is <strong><code>iter.max=20L</code></strong>
</li>
<li>
<strong><code>stop</code></strong>: Stopping rule, default is
<strong><code>stop="ratch"</code></strong>:
<ul>
<li>
<strong><code>incre</code></strong>: We define <span class="math inline">\((l^{(m)}-l^{(m-1)})/(l^{(m)}-l^{(0)})\)</span> as
the relative change of the log-partial likelihood, where m denotes the
mth step of the algorithm. When it’s smaller than a certain threshold,
we stop the algorithm. tol is the variable determining the convergence
threshold.</li>
<li>
<strong><code>relch</code></strong>: We define the relative change
of the log-partial likelihood as <span class="math inline">\((l^{(m)}-l^{(m-1)})/(l^{(m)})\)</span>, which
makes it easier to converge.</li>
<li>
<strong><code>incre</code></strong>: This method would stop the
algorithm when the half of the Newton increment is less than the
threshold(<code>tol</code> defined in the previous argument??
correct??).</li>
</ul>
</li>
<li>
<strong><code>fixedstep</code></strong>: There might be times when
the stopping criteria not working, thus, the number of steps could be
set manually. Default value is
<strong><code>fixedstep = FALSE</code></strong>, if it is true, will
stop by <code>iter.max</code>
</li>
</ul>
<div class="section level4">
<h4 id="other-parameters">1.1.4 Other Parameters:<a class="anchor" aria-label="anchor" href="#other-parameters"></a>
</h4>
<ul>
<li>
<strong><code>ties</code></strong>: Ways to deal with ties, default
is <strong><code>ties="Breslow"</code></strong>:
<ul>
<li>
<strong><code>"Breslow"</code></strong>: Breslow approximation.
Detailed information could be found here(add link)</li>
<li>
<strong><code>"none</code></strong>: Don’t deal with ties</li>
</ul>
</li>
<li>
<strong><code>btr</code></strong>: Backtracking line search
approach, default is <code>btr="static"</code>:
<ul>
<li>
<strong><code>"none"</code></strong>: Don’t do Backtracking
Linesearch.</li>
<li>
<strong><code>"static"</code></strong> : When binary predictors with
extremely low frequency are present, calculation of the second order
derivative has some issues. In that case, the Newton increment presents
extreme values, leading to huge bias. We provided a way of limiting the
step size in such cases. Instead of using the Newton increment, we use a
fixed value of 1. This method is referred as “static” in our function.
Since it moves slower, usually it can not achieve maximum likelihood
estimator, leading to biased estimation.</li>
<li>
<strong><code>"dynamic"</code></strong> : Backtracking Linesearch
with Newton Increment. Detail information could be found at(Add
link)</li>
</ul>
</li>
<li>
<strong><code>parallel</code></strong>: Parallel computation,
Default is <strong><code>parallel=FALSE</code></strong>
</li>
<li>
<strong><code>threads</code></strong> : Parallel computation
parameter(number of cores)Default is
<strong><code>threads=1L</code></strong>
</li>
<li>
<strong><code>TIC_prox</code></strong> : When calculating
information criteria, there might be numerical issue(second order
derivative, Hessian matrix approximate is singular), thus we proposed to
add a small term to the diagonal. Default
<strong><code>TIC_prox = FALSE</code></strong>
</li>
<li>
<strong><code>ICLastOnly</code></strong> : Only calculate the last
information criteria if is TRUE. Default is
<strong><code>ICLastOnly=FALSE</code></strong>
</li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="coxtp-plot">1.2. coxtp.plot<a class="anchor" aria-label="anchor" href="#coxtp-plot"></a>
</h3>
<p><code>coxtp.plot(fit,IC="AIC",coef,xlab="Time",ylab="Hazard Ratio (log-scale)")</code></p>
<p>Function <code>coxtp.plot</code> was created to generate related
hazard ratio plot from the result generated from <code>coxtp</code></p>
<ul>
<li>
<strong><code>fit</code></strong>: Model fitted from coxtp</li>
<li>
<strong><code>IC</code></strong> :The Criteria selected for the
plotting. Default is IC=“AIC”.
<ul>
<li>
<strong><code>IC</code></strong>=“TIC”: Takeuchi information
criterion (Insert link here)</li>
<li>
<strong><code>IC</code></strong>=“GIC”: Generalized information
criterion (Insert link here)</li>
<li>
<strong><code>IC</code></strong>=“AIC”: Akakia information criterion
(Insert link here)</li>
</ul>
</li>
<li>
<strong><code>coef</code></strong>: The variable that needed to be
plotted</li>
<li>
<strong><code>xlab</code></strong>: X axis label, default is
xlab=“Time”</li>
<li>
<strong><code>ylab</code></strong>: X axis label, default is
ylab=“Hazard Ratio (log-scale)”</li>
</ul>
</div>
<div class="section level3">
<h3 id="coxtp-baseline">1.3. coxtp.baseline<a class="anchor" aria-label="anchor" href="#coxtp-baseline"></a>
</h3>
<p><code>coxtp.baseline(fit, delta,z,time,strata=c())</code></p>
<ul>
<li>
<strong><code>fit</code></strong>: Model fitted from coxtp</li>
<li>
<strong><code>delta</code></strong>: Event vector, should be a
vector containing 0 or 1</li>
<li>
<strong><code>z</code></strong>: Covariate matrix</li>
<li>
<strong><code>time</code></strong>: Time vector, should be a vector
with non-negative numeric value.</li>
<li>
<strong><code>strata</code></strong>: stratification group defined
in the data. If there exist stratification group, please enter as
vector.</li>
</ul>
</div>
<div class="section level3">
<h3 id="coxtp-predict">1.4 coxtp.predict<a class="anchor" aria-label="anchor" href="#coxtp-predict"></a>
</h3>
<p><code>coxtp.predict(fit,baseline,newdata=c(),strata=FALSE)</code></p>
<ul>
<li>
<strong><code>fit</code></strong>: Model get from coxtp</li>
<li>
<strong><code>baseline</code></strong>: Baseline estimation from
coxtp.baseline or the arbitary baseline entered</li>
<li>
<strong><code>newdata</code></strong>: New data in vector</li>
<li>
<strong><code>strata</code></strong>: Whether there is
stratification in the dataset, default is FALSE.</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="data-sets">2. Data sets<a class="anchor" aria-label="anchor" href="#data-sets"></a>
</h2>
<div class="section level3">
<h3 id="sim_data">2.1 sim_data<a class="anchor" aria-label="anchor" href="#sim_data"></a>
</h3>
<p>Example data for surtvep with 5000 observations of 4 variables</p>
<ul>
<li>
<strong><code>V1</code></strong>: Simulated covariate V1, Binary
variable with 0, 1. True time-dependent function is <span class="math inline">\(\beta(t)=1\)</span>
</li>
<li>
<strong><code>V2</code></strong>: Simulated covariate V2, Binary
variable with 0, 1. True time-dependent function is <span class="math inline">\(\beta(t)=exp(-1.5*t)\)</span>
</li>
<li>
<strong><code>event</code></strong>: Simulated event variable,
Binary varible with 0, 1</li>
<li>
<strong><code>time</code></strong>: Simulated time variable,
Continous variable with non-negative value</li>
</ul>
</div>
<div class="section level3">
<h3 id="sim_data_p5">2.2 sim_data_p5<a class="anchor" aria-label="anchor" href="#sim_data_p5"></a>
</h3>
<p>Example data for surtvep with 5000 observations of 7 variables:</p>
<ul>
<li>
<strong><code>V1</code></strong>: Simulated covariate V1, Binary
variable with 0, 1. True time-dependent function is <span class="math inline">\(\beta(t)=1\)</span>
</li>
<li>
<strong><code>V2</code></strong>: Simulated covariate V2, Binary
variable with 0, 1. True time-dependent function is <span class="math inline">\(\beta(t)=sin(3\pi t/4)\)</span>
</li>
<li>
<strong><code>V3</code></strong>: Simulated covariate V2, Binary
variable with 0, 1. True time-dependent function is <span class="math inline">\(\beta(t)=-1\)</span>
</li>
<li>
<strong><code>V4</code></strong>: Simulated covariate V2, Binary
variable with 0, 1. True time-dependent function is <span class="math inline">\(\beta(t)=(t/3)**2exp(t/2)\)</span>
</li>
<li>
<strong><code>V5</code></strong>: Simulated covariate V2, Binary
variable with 0, 1. True time-dependent function is <span class="math inline">\(\beta(t)=exp(-1.5t)\)</span>
</li>
<li>
<strong><code>event</code></strong>: Simulated event variable,
Binary varible with 0, 1 }</li>
<li>
<strong><code>time</code></strong>: Simulated time variable,
Continous variable with non-negative value}</li>
</ul>
</div>
<div class="section level3">
<h3 id="sim_data_p5_f5">2.3 sim_data_p5_f5<a class="anchor" aria-label="anchor" href="#sim_data_p5_f5"></a>
</h3>
<p>Example data for surtvep with 5000 observations of 8 variables(With
strata):</p>
<ul>
<li>
<strong><code>V1</code></strong>: Simulated covariate V1, Binary
variable with 0, 1. True time-dependent function is <span class="math inline">\(\beta(t)=1\)</span>
</li>
<li>
<strong><code>V2</code></strong>: Simulated covariate V2, Binary
variable with 0, 1. True time-dependent function is <span class="math inline">\(\beta(t)=sin(3\pi t/4)\)</span>
</li>
<li>
<strong><code>V3</code></strong>: Simulated covariate V2, Binary
variable with 0, 1. True time-dependent function is <span class="math inline">\(\beta(t)=-1\)</span>
</li>
<li>
<strong><code>V4</code></strong>: Simulated covariate V2, Binary
variable with 0, 1. True time-dependent function is <span class="math inline">\(\beta(t)=(t/3)**2exp(t/2)\)</span>
</li>
<li>
<strong><code>V5</code></strong>: Simulated covariate V2, Binary
variable with 0, 1. True time-dependent function is <span class="math inline">\(\beta(t)=exp(-1.5t)\)</span>
</li>
<li>
<strong><code>event</code></strong>: Simulated event variable,
Binary variable with 0, 1</li>
<li>
<strong><code>time</code></strong>: Simulated time variable,
Continuous variable with non-negative value</li>
<li>
<strong><code>facility</code></strong>: Simulated stratification
variable. Have 5 levels</li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Lingfeng Luo, <a href="https://www.wenbowu.me/" class="external-link">Wenbo Wu</a>, <a href="https://www.um-kevinhe-group.org/" class="external-link">Kevin He</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
